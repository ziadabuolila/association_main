<!DOCTYPE html>
<html lang="ar">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="../img/association.png" />
    <link rel="stylesheet" href="../css/donations_table.css" />
    <title>استقبال التبرعات</title>
  </head>

  <body>
    <header>
      <div class="logo">
        <img src="../img/association.png" alt="Logo" draggable="false" />
      </div>
      <div class="company_name">
        <h4>جمعية الرحمة الخيرية بعزبة عمرو</h4>
      </div>
    </header>

    <div class="table-container">
      <table class="table">
        <thead>
          <tr>
            <th>#</th>
            <th>الاسم الكامل</th>
            <th>رقم الهاتف</th>
            <th>البريد الإلكتروني</th>
            <th>نوع التبرع</th>
            <th>بيانات التبرع</th>
            <th>الخيارات</th>
          </tr>
        </thead>
        <tbody id="tableBodyDonations"></tbody>
      </table>
    </div>
    <script>
      const tableBody = document.getElementById("tableBodyDonations");
      let donations = JSON.parse(localStorage.getItem("donations")) || [];

      function renderTable() {
        tableBody.innerHTML = "";

        donations.forEach((donation, index) => {
          let extraText = "";

          for (let key in donation.extraInfo) {
            extraText += `<div><strong>${key}:</strong> ${donation.extraInfo[key]}</div>`;
          }

          tableBody.innerHTML += `
        <tr data-id="${donation.id}">
          <td>${index + 1}</td>
          <td>${donation.name}</td>
          <td>${donation.phone}</td>
          <td>${donation.email}</td>
          <td>
            <span class="badge-donation">
              ${donation.donationType}
            </span>
          </td>
          <td>
            <strong>${donation.amount}</strong><br>
            ${donation.paymentMethod}<br>
            ${extraText}
          </td>
          <td>
            <button class="btn-delete" onclick="deleteDonation(${donation.id})">
              حذف
            </button>
          </td>
        </tr>
      `;
        });
      }

      function deleteDonation(id) {
        donations = donations.filter((donation) => donation.id !== id);
        localStorage.setItem("donations", JSON.stringify(donations));
        renderTable();
      }

      renderTable();
    </script>
  </body>
</html>
